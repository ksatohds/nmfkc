<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NMF-SEM Main Estimation Algorithm — nmf.sem • nmfkc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="NMF-SEM Main Estimation Algorithm — nmf.sem"><meta property="og:description" content="Fits the NMF-SEM model
$$
  Y_1 \approx X \bigl( \Theta_1 Y_1 + \Theta_2 Y_2 \bigr)
$$
under non-negativity constraints with orthogonality and sparsity regularization.
The function returns the estimated latent factors, structural coefficient matrices,
and the implied equilibrium (input–output) mapping.
At equilibrium, the model can be written as
$$
  Y_1 \approx (I - X \Theta_1)^{-1} X \Theta_2 Y_2
  \equiv M_{\mathrm{model}} Y_2,
$$
where \(M_{\mathrm{model}} = (I - X \Theta_1)^{-1} X \Theta_2\) is a
Leontief-type cumulative-effect operator in latent space.
Internally, the latent feedback and exogenous loading matrices are stored as
C1 and C2, corresponding to \(\Theta_1\) and \(\Theta_2\),
respectively."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nmfkc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/classification-with-nmfkc.html">Classification with NMF-LAB</a>
    </li>
    <li>
      <a href="../articles/introduction-to-nmfkc.html">Introduction to nmfkc</a>
    </li>
    <li>
      <a href="../articles/nmf-sem-with-nmfkc.html">NMF-SEM with nmfkc</a>
    </li>
    <li>
      <a href="../articles/timeseries-with-nmfkc.html">Time Series Analysis with NMF-VAR</a>
    </li>
    <li>
      <a href="../articles/topic-modeling-with-nmfkc.html">Topic Modeling with nmfkc</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ksatohds/nmfkc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>NMF-SEM Main Estimation Algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/ksatohds/nmfkc/blob/HEAD/R/nmfkc.R" class="external-link"><code>R/nmfkc.R</code></a></small>
    <div class="hidden name"><code>nmf.sem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits the NMF-SEM model
$$
  Y_1 \approx X \bigl( \Theta_1 Y_1 + \Theta_2 Y_2 \bigr)
$$
under non-negativity constraints with orthogonality and sparsity regularization.
The function returns the estimated latent factors, structural coefficient matrices,
and the implied equilibrium (input–output) mapping.</p>
<p>At equilibrium, the model can be written as
$$
  Y_1 \approx (I - X \Theta_1)^{-1} X \Theta_2 Y_2
  \equiv M_{\mathrm{model}} Y_2,
$$
where \(M_{\mathrm{model}} = (I - X \Theta_1)^{-1} X \Theta_2\) is a
Leontief-type cumulative-effect operator in latent space.</p>
<p>Internally, the latent feedback and exogenous loading matrices are stored as
<code>C1</code> and <code>C2</code>, corresponding to \(\Theta_1\) and \(\Theta_2\),
respectively.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmf.sem</span><span class="op">(</span></span>
<span>  <span class="va">Y1</span>,</span>
<span>  <span class="va">Y2</span>,</span>
<span>  rank <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.L2.ortho <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  C1.L1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  C2.L1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y-">Y1<a class="anchor" aria-label="anchor" href="#arg-y-"></a></dt>
<dd><p>A non-negative numeric matrix of endogenous variables with
<strong>rows = variables (P1), columns = samples (N)</strong>.</p></dd>


<dt id="arg-y-">Y2<a class="anchor" aria-label="anchor" href="#arg-y-"></a></dt>
<dd><p>A non-negative numeric matrix of exogenous variables with
<strong>rows = variables (P2), columns = samples (N)</strong>.
Must satisfy <code>ncol(Y1) == ncol(Y2)</code>.</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>Integer; number of latent factors \(Q\). If <code>NULL</code>,
\(Q\) is taken from a hidden argument in <code>...</code> or defaults to
<code>nrow(Y2)</code>.</p></dd>


<dt id="arg-x-init">X.init<a class="anchor" aria-label="anchor" href="#arg-x-init"></a></dt>
<dd><p>Optional non-negative initialization for the basis matrix
<code>X</code> (\(P_1 \times Q\)). If supplied, it is projected to be
non-negative and column-normalized.</p></dd>


<dt id="arg-x-l-ortho">X.L2.ortho<a class="anchor" aria-label="anchor" href="#arg-x-l-ortho"></a></dt>
<dd><p>L2 orthogonality penalty for <code>X</code>. This controls
the penalty term \(\lambda_X \lVert X^\top X - \mathrm{diag}(X^\top X)
  \rVert_F^2\). Default: <code>100</code>.</p></dd>


<dt id="arg-c-l-">C1.L1<a class="anchor" aria-label="anchor" href="#arg-c-l-"></a></dt>
<dd><p>L1 sparsity penalty for <code>C1</code> (i.e., \(\Theta_1\)).
Default: <code>1.0</code>.</p></dd>


<dt id="arg-c-l-">C2.L1<a class="anchor" aria-label="anchor" href="#arg-c-l-"></a></dt>
<dd><p>L1 sparsity penalty for <code>C2</code> (i.e., \(\Theta_2\)).
Default: <code>0.1</code>.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Relative convergence threshold for the objective function.
Iterations stop when the relative change in reconstruction loss falls
below this value. Default: <code>1e-6</code>.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations for the multiplicative updates.
Default: <code>20000</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed used to initialize <code>X</code>, <code>C1</code>, and <code>C2</code>.
Default: <code>123</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments. Currently used to pass a hidden rank
<code>Q</code> (e.g., via <code>Q = 3</code>) if <code>rank</code> is <code>NULL</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with components:</p>
<dl><dt>X</dt>
<dd><p>Estimated basis matrix (\(P_1 \times Q\)).</p></dd>

<dt>C1</dt>
<dd><p>Estimated latent feedback matrix (\(\Theta_1\), \(Q \times P_1\)).</p></dd>

<dt>C2</dt>
<dd><p>Estimated exogenous loading matrix (\(\Theta_2\), \(Q \times P_2\)).</p></dd>

<dt>XC1</dt>
<dd><p>Feedback matrix \(X \Theta_1\).</p></dd>

<dt>XC2</dt>
<dd><p>Direct-effect matrix \(X \Theta_2\).</p></dd>

<dt>XC1.radius</dt>
<dd><p>Spectral radius \(\rho(X \Theta_1)\).</p></dd>

<dt>XC1.norm1</dt>
<dd><p>Induced 1-norm \(\lVert X \Theta_1 \rVert_{1,\mathrm{op}}\).</p></dd>

<dt>Leontief.inv</dt>
<dd><p>Leontief-type inverse \((I - X \Theta_1)^{-1}.\)</p></dd>

<dt>M.model</dt>
<dd><p>Equilibrium mapping
\(M_{\mathrm{model}} = (I - X \Theta_1)^{-1} X \Theta_2\).</p></dd>

<dt>amplification</dt>
<dd><p>Latent amplification factor
\(\lVert M_{\mathrm{model}} \rVert_{1,\mathrm{op}} /
         \bigl\lVert X \Theta_2 \bigr\rVert_{1,\mathrm{op}}\).</p></dd>

<dt>amplification.bound</dt>
<dd><p>Geometric-series upper bound
\(1 / (1 - \lVert X \Theta_1 \rVert_{1,\mathrm{op}})\) if
\(\lVert X \Theta_1 \rVert_{1,\mathrm{op}} &lt; 1\), otherwise <code>Inf</code>.</p></dd>

<dt>Q</dt>
<dd><p>Effective latent dimension used in the fit.</p></dd>

<dt>SC.cov</dt>
<dd><p>Correlation between sample and model-implied covariance
(flattened) of \(Y_1\).</p></dd>

<dt>MAE</dt>
<dd><p>Mean absolute error between \(Y_1\) and its equilibrium
prediction \(\hat Y_1 = M_{\mathrm{model}} Y_2\).</p></dd>

<dt>objfunc</dt>
<dd><p>Vector of reconstruction losses per iteration.</p></dd>

<dt>objfunc.full</dt>
<dd><p>Vector of penalized objective values per iteration.</p></dd>

<dt>iter</dt>
<dd><p>Number of iterations actually performed.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kenichi Satoh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

