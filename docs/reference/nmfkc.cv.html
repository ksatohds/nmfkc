<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform k-fold cross-validation for NMF with kernel covariates — nmfkc.cv • nmfkc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform k-fold cross-validation for NMF with kernel covariates — nmfkc.cv"><meta name="description" content="nmfkc.cv performs k-fold cross-validation for the tri-factorization model
\(Y \approx X C A = X B\), where
\(Y(P,N)\) is the observation matrix,
\(A(R,N)\) is the covariate (or kernel) matrix,
\(X(P,Q)\) is the basis matrix (with \(Q \le \min(P,N)\)),
\(C(Q,R)\) is the parameter matrix, and
\(B(Q,N)\) is the coefficient matrix (\(B = C A\)).
Given \(Y\) (and optionally \(A\)), \(X\) and \(C\) are fitted on each
training split and predictive performance is evaluated on the held-out split."><meta property="og:description" content="nmfkc.cv performs k-fold cross-validation for the tri-factorization model
\(Y \approx X C A = X B\), where
\(Y(P,N)\) is the observation matrix,
\(A(R,N)\) is the covariate (or kernel) matrix,
\(X(P,Q)\) is the basis matrix (with \(Q \le \min(P,N)\)),
\(C(Q,R)\) is the parameter matrix, and
\(B(Q,N)\) is the coefficient matrix (\(B = C A\)).
Given \(Y\) (and optionally \(A\)), \(X\) and \(C\) are fitted on each
training split and predictive performance is evaluated on the held-out split."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nmfkc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/classification-with-nmfkc.html">Classification with NMF-LAB</a></li>
    <li><a class="dropdown-item" href="../articles/introduction-to-nmfkc.html">Introduction to nmfkc</a></li>
    <li><a class="dropdown-item" href="../articles/timeseries-with-nmfkc.html">Time Series Analysis with NMF-VAR</a></li>
    <li><a class="dropdown-item" href="../articles/topic-modeling-with-nmfkc.html">Topic Modeling with nmfkc</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ksatohds/nmfkc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform k-fold cross-validation for NMF with kernel covariates</h1>
      <small class="dont-index">Source: <a href="https://github.com/ksatohds/nmfkc/blob/HEAD/R/nmfkc.R" class="external-link"><code>R/nmfkc.R</code></a></small>
      <div class="d-none name"><code>nmfkc.cv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>nmfkc.cv</code> performs k-fold cross-validation for the tri-factorization model
\(Y \approx X C A = X B\), where</p><ul><li><p>\(Y(P,N)\) is the observation matrix,</p></li>
<li><p>\(A(R,N)\) is the covariate (or kernel) matrix,</p></li>
<li><p>\(X(P,Q)\) is the basis matrix (with \(Q \le \min(P,N)\)),</p></li>
<li><p>\(C(Q,R)\) is the parameter matrix, and</p></li>
<li><p>\(B(Q,N)\) is the coefficient matrix (\(B = C A\)).</p></li>
</ul><p>Given \(Y\) (and optionally \(A\)), \(X\) and \(C\) are fitted on each
training split and predictive performance is evaluated on the held-out split.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, A <span class="op">=</span> <span class="cn">NULL</span>, Q <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Observation matrix.</p></dd>


<dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>Covariate matrix. If <code>NULL</code>, the identity matrix is used.</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Rank of the basis matrix \(X\); must satisfy \(Q \le \min(P,N)\).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments controlling CV and the internal <code><a href="nmfkc.html">nmfkc</a></code> call:</p><dl><dt><code>Y.weights</code></dt>
<dd><p>Optional numeric matrix or vector; 0 indicates missing/ignored values.</p></dd>

<dt><code>div</code></dt>
<dd><p>Number of folds (\(k\)); default: <code>5</code>.</p></dd>

<dt><code>seed</code></dt>
<dd><p>Integer seed for reproducible partitioning; default: <code>123</code>.</p></dd>

<dt><code>shuffle</code></dt>
<dd><p>Logical. If <code>TRUE</code> (default), randomly shuffles samples (standard CV);
if <code>FALSE</code>, splits sequentially (block CV; recommended for time series).</p></dd>

<dt><em>Arguments passed to</em> <code><a href="nmfkc.html">nmfkc</a></code></dt>
<dd><p>e.g., <code>gamma</code> (<code>B.L1</code>), <code>epsilon</code>,
<code>maxit</code>, <code>method</code> (<code>"EU"</code> or <code>"KL"</code>), <code>X.restriction</code>, <code>X.init</code>, etc.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt><code>objfunc</code></dt>
<dd><p>Mean loss per valid entry over all folds (MSE for <code>method="EU"</code>).</p></dd>

<dt><code>sigma</code></dt>
<dd><p>Residual standard error (RMSE). Available only if <code>method="EU"</code>; on the same scale as <code>Y</code>.</p></dd>

<dt><code>objfunc.block</code></dt>
<dd><p>Loss for each fold.</p></dd>

<dt><code>block</code></dt>
<dd><p>Vector of fold indices (1, …, <code>div</code>) assigned to each column of \(Y\).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="nmfkc.html">nmfkc</a></code>, <code><a href="nmfkc.kernel.beta.cv.html">nmfkc.kernel.beta.cv</a></code>, <code><a href="nmfkc.ar.degree.cv.html">nmfkc.ar.degree.cv</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1 (with explicit covariates):</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, <span class="va">A</span>, Q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">objfunc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 286.3378</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2 (kernel A and beta sweep):</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">betas</span> <span class="op">&lt;-</span> <span class="fl">25</span><span class="op">:</span><span class="fl">35</span><span class="op">/</span><span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">betas</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">betas</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="nmfkc.kernel.html">nmfkc.kernel</a></span><span class="op">(</span><span class="va">U</span>, <span class="va">V</span>, beta <span class="op">=</span> <span class="va">betas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">obj</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, <span class="va">A</span>, Q <span class="op">=</span> <span class="fl">1</span>, div <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">objfunc</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">betas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.031</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kenichi Satoh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

