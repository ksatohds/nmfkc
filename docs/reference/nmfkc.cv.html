<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform k-fold cross-validation for NMF with kernel covariates — nmfkc.cv • nmfkc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform k-fold cross-validation for NMF with kernel covariates — nmfkc.cv"><meta property="og:description" content="nmfkc.cv performs k-fold cross-validation for the tri-factorization model
\(Y \approx X C A = X B\), where
\(Y(P,N)\) is the observation matrix,
\(A(R,N)\) is the covariate (or kernel) matrix,
\(X(P,Q)\) is the basis matrix (with \(Q \le \min(P,N)\)),
\(C(Q,R)\) is the parameter matrix, and
\(B(Q,N)\) is the coefficient matrix (\(B = C A\)).
Given \(Y\) (and optionally \(A\)), \(X\) and \(C\) are fitted on each
training split and predictive performance is evaluated on the held-out split."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nmfkc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/classification-with-nmfkc.html">Classification with NMF-LAB</a>
    </li>
    <li>
      <a href="../articles/introduction-to-nmfkc.html">Introduction to nmfkc</a>
    </li>
    <li>
      <a href="../articles/nmf-sem-with-nmfkc.html">NMF-SEM with nmfkc</a>
    </li>
    <li>
      <a href="../articles/timeseries-with-nmfkc.html">Time Series Analysis with NMF-VAR</a>
    </li>
    <li>
      <a href="../articles/topic-modeling-with-nmfkc.html">Topic Modeling with nmfkc</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ksatohds/nmfkc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform k-fold cross-validation for NMF with kernel covariates</h1>
    <small class="dont-index">Source: <a href="https://github.com/ksatohds/nmfkc/blob/HEAD/R/nmfkc.R" class="external-link"><code>R/nmfkc.R</code></a></small>
    <div class="hidden name"><code>nmfkc.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>nmfkc.cv</code> performs k-fold cross-validation for the tri-factorization model
\(Y \approx X C A = X B\), where</p><ul><li><p>\(Y(P,N)\) is the observation matrix,</p></li>
<li><p>\(A(R,N)\) is the covariate (or kernel) matrix,</p></li>
<li><p>\(X(P,Q)\) is the basis matrix (with \(Q \le \min(P,N)\)),</p></li>
<li><p>\(C(Q,R)\) is the parameter matrix, and</p></li>
<li><p>\(B(Q,N)\) is the coefficient matrix (\(B = C A\)).</p></li>
</ul><p>Given \(Y\) (and optionally \(A\)), \(X\) and \(C\) are fitted on each
training split and predictive performance is evaluated on the held-out split.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, A <span class="op">=</span> <span class="cn">NULL</span>, Q <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Observation matrix.</p></dd>


<dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>Covariate matrix. If <code>NULL</code>, the identity matrix is used.</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Rank of the basis matrix \(X\); must satisfy \(Q \le \min(P,N)\).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments controlling CV and the internal <code><a href="nmfkc.html">nmfkc</a></code> call:</p><dl><dt><code>Y.weights</code></dt>
<dd><p>Optional numeric matrix or vector; 0 indicates missing/ignored values.</p></dd>

<dt><code>div</code></dt>
<dd><p>Number of folds (\(k\)); default: <code>5</code>.</p></dd>

<dt><code>seed</code></dt>
<dd><p>Integer seed for reproducible partitioning; default: <code>123</code>.</p></dd>

<dt><code>shuffle</code></dt>
<dd><p>Logical. If <code>TRUE</code> (default), randomly shuffles samples (standard CV);
if <code>FALSE</code>, splits sequentially (block CV; recommended for time series).</p></dd>

<dt><em>Arguments passed to</em> <code><a href="nmfkc.html">nmfkc</a></code></dt>
<dd><p>e.g., <code>gamma</code> (<code>B.L1</code>), <code>epsilon</code>,
<code>maxit</code>, <code>method</code> (<code>"EU"</code> or <code>"KL"</code>), <code>X.restriction</code>, <code>X.init</code>, etc.</p></dd>


</dl></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with components:</p><dl><dt><code>objfunc</code></dt>
<dd><p>Mean loss per valid entry over all folds (MSE for <code>method="EU"</code>).</p></dd>

<dt><code>sigma</code></dt>
<dd><p>Residual standard error (RMSE). Available only if <code>method="EU"</code>; on the same scale as <code>Y</code>.</p></dd>

<dt><code>objfunc.block</code></dt>
<dd><p>Loss for each fold.</p></dd>

<dt><code>block</code></dt>
<dd><p>Vector of fold indices (1, …, <code>div</code>) assigned to each column of \(Y\).</p></dd>


</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="nmfkc.html">nmfkc</a></code>, <code><a href="nmfkc.kernel.beta.cv.html">nmfkc.kernel.beta.cv</a></code>, <code><a href="nmfkc.ar.degree.cv.html">nmfkc.ar.degree.cv</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1 (with explicit covariates):</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, <span class="va">A</span>, Q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">objfunc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 286.3378</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2 (kernel A and beta sweep):</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">betas</span> <span class="op">&lt;-</span> <span class="fl">25</span><span class="op">:</span><span class="fl">35</span><span class="op">/</span><span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">betas</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">betas</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="nmfkc.kernel.html">nmfkc.kernel</a></span><span class="op">(</span><span class="va">U</span>, <span class="va">V</span>, beta <span class="op">=</span> <span class="va">betas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">obj</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">nmfkc.cv</span><span class="op">(</span><span class="va">Y</span>, <span class="va">A</span>, Q <span class="op">=</span> <span class="fl">1</span>, div <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">objfunc</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">betas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.031</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kenichi Satoh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

