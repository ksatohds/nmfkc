<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cross-Validation for NMF-SEM — nmf.sem.cv • nmfkc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-Validation for NMF-SEM — nmf.sem.cv"><meta property="og:description" content="Performs K-fold cross-validation to evaluate the equilibrium mapping of
the NMF-SEM model.
For each fold, nmf.sem is fitted on the training samples,
yielding an equilibrium mapping \(\hat Y_1 = M_{\mathrm{model}} Y_2\).
The held-out endogenous variables \(Y_1\) are then predicted from \(Y_2\)
using this mapping, and the mean absolute error (MAE) over all entries in the
test block is computed. The returned value is the average MAE across folds.
This implements the hyperparameter selection strategy described in the paper:
hyperparameters are chosen by predictive cross-validation rather than direct
inspection of the internal structural matrices."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nmfkc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/classification-with-nmfkc.html">Classification with NMF-LAB</a>
    </li>
    <li>
      <a href="../articles/introduction-to-nmfkc.html">Introduction to nmfkc</a>
    </li>
    <li>
      <a href="../articles/nmf-sem-with-nmfkc.html">NMF-SEM with nmfkc</a>
    </li>
    <li>
      <a href="../articles/timeseries-with-nmfkc.html">Time Series Analysis with NMF-VAR</a>
    </li>
    <li>
      <a href="../articles/topic-modeling-with-nmfkc.html">Topic Modeling with nmfkc</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ksatohds/nmfkc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-Validation for NMF-SEM</h1>
    <small class="dont-index">Source: <a href="https://github.com/ksatohds/nmfkc/blob/HEAD/R/nmfkc.R" class="external-link"><code>R/nmfkc.R</code></a></small>
    <div class="hidden name"><code>nmf.sem.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs K-fold cross-validation to evaluate the equilibrium mapping of
the NMF-SEM model.</p>
<p>For each fold, <code>nmf.sem</code> is fitted on the training samples,
yielding an equilibrium mapping \(\hat Y_1 = M_{\mathrm{model}} Y_2\).
The held-out endogenous variables \(Y_1\) are then predicted from \(Y_2\)
using this mapping, and the mean absolute error (MAE) over all entries in the
test block is computed. The returned value is the average MAE across folds.</p>
<p>This implements the hyperparameter selection strategy described in the paper:
hyperparameters are chosen by predictive cross-validation rather than direct
inspection of the internal structural matrices.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmf.sem.cv</span><span class="op">(</span></span>
<span>  <span class="va">Y1</span>,</span>
<span>  <span class="va">Y2</span>,</span>
<span>  rank <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.L2.ortho <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  C1.L1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  C2.L1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  div <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  shuffle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y-">Y1<a class="anchor" aria-label="anchor" href="#arg-y-"></a></dt>
<dd><p>A non-negative numeric matrix of endogenous variables with
<strong>rows = variables (P1), columns = samples (N)</strong>.</p></dd>


<dt id="arg-y-">Y2<a class="anchor" aria-label="anchor" href="#arg-y-"></a></dt>
<dd><p>A non-negative numeric matrix of exogenous variables with
<strong>rows = variables (P2), columns = samples (N)</strong>.
Must satisfy <code>ncol(Y1) == ncol(Y2)</code>.</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>Integer; rank (number of latent factors) passed to <code>nmf.sem</code>.
If <code>NULL</code>, <code>nmf.sem</code> decides the effective rank (via <code>...</code> or <code>nrow(Y2)</code>).</p></dd>


<dt id="arg-x-init">X.init<a class="anchor" aria-label="anchor" href="#arg-x-init"></a></dt>
<dd><p>Optional initialization for <code>X</code> (as in <code>nmf.sem</code>).</p></dd>


<dt id="arg-x-l-ortho">X.L2.ortho<a class="anchor" aria-label="anchor" href="#arg-x-l-ortho"></a></dt>
<dd><p>L2 orthogonality penalty for <code>X</code>.</p></dd>


<dt id="arg-c-l-">C1.L1<a class="anchor" aria-label="anchor" href="#arg-c-l-"></a></dt>
<dd><p>L1 sparsity penalty for <code>C1</code> (\(\Theta_1\)).</p></dd>


<dt id="arg-c-l-">C2.L1<a class="anchor" aria-label="anchor" href="#arg-c-l-"></a></dt>
<dd><p>L1 sparsity penalty for <code>C2</code> (\(\Theta_2\)).</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Convergence threshold for <code>nmf.sem</code>.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations for <code>nmf.sem</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Master random seed for CV splitting and fold-specific calls to <code>nmf.sem</code>.
If <code>NULL</code>, RNG is not controlled within folds.</p></dd>


<dt id="arg-div">div<a class="anchor" aria-label="anchor" href="#arg-div"></a></dt>
<dd><p>Number of CV folds. (Default: <code>5</code>)</p></dd>


<dt id="arg-shuffle">shuffle<a class="anchor" aria-label="anchor" href="#arg-shuffle"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, samples are randomly permuted
before assigning to folds. (Default: <code>TRUE</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>nmf.sem</code> (except for
<code>rank</code>, <code>seed</code>, <code>div</code>, <code>shuffle</code>, which are handled here).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric scalar: mean MAE across CV folds.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kenichi Satoh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

