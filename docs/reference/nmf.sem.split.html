<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Heuristic Variable Splitting for NMF-SEM — nmf.sem.split • nmfkc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Heuristic Variable Splitting for NMF-SEM — nmf.sem.split"><meta property="og:description" content="Infers a heuristic partition of observed variables into exogenous (\(Y_2\))
and endogenous (\(Y_1\)) blocks for use in NMF-SEM.
The method is based on positive-SEM logic, causal ordering, and optional
sign alignment using the first principal component (PC1).
The procedure:
internally standardizes variables (mean 0, sd 1),
optionally flips signs so that most variables align positively with PC1,
infers a causal ordering by repeatedly regressing each variable on the
remaining ones and selecting the variable with the largest minimum
standardized coefficient,
determines an exogenous block by scanning the ordering from upstream
and stopping at the first variable whose strongest parent coefficient
exceeds threshold.


If n.exogenous is supplied, it overrides the automatic threshold rule."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nmfkc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/classification-with-nmfkc.html">Classification with NMF-LAB</a>
    </li>
    <li>
      <a href="../articles/introduction-to-nmfkc.html">Introduction to nmfkc</a>
    </li>
    <li>
      <a href="../articles/nmf-sem-with-nmfkc.html">NMF-SEM with nmfkc</a>
    </li>
    <li>
      <a href="../articles/timeseries-with-nmfkc.html">Time Series Analysis with NMF-VAR</a>
    </li>
    <li>
      <a href="../articles/topic-modeling-with-nmfkc.html">Topic Modeling with nmfkc</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ksatohds/nmfkc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Heuristic Variable Splitting for NMF-SEM</h1>
    <small class="dont-index">Source: <a href="https://github.com/ksatohds/nmfkc/blob/HEAD/R/nmfkc.R" class="external-link"><code>R/nmfkc.R</code></a></small>
    <div class="hidden name"><code>nmf.sem.split.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Infers a heuristic partition of observed variables into exogenous (\(Y_2\))
and endogenous (\(Y_1\)) blocks for use in NMF-SEM.
The method is based on positive-SEM logic, causal ordering, and optional
sign alignment using the first principal component (PC1).</p>
<p>The procedure:</p><ul><li><p>internally standardizes variables (mean 0, sd 1),</p></li>
<li><p>optionally flips signs so that most variables align positively with PC1,</p></li>
<li><p>infers a causal ordering by repeatedly regressing each variable on the
remaining ones and selecting the variable with the largest minimum
standardized coefficient,</p></li>
<li><p>determines an exogenous block by scanning the ordering from upstream
and stopping at the first variable whose strongest parent coefficient
exceeds <code>threshold</code>.</p></li>
</ul><p>If <code>n.exogenous</code> is supplied, it overrides the automatic threshold rule.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmf.sem.split</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n.exogenous <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  auto.flipped <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric matrix or data frame with
<strong>rows = samples</strong> and <strong>columns = observed variables</strong>.</p></dd>


<dt id="arg-n-exogenous">n.exogenous<a class="anchor" aria-label="anchor" href="#arg-n-exogenous"></a></dt>
<dd><p>Optional integer specifying the number of exogenous variables
(\(Y_2\)). If <code>NULL</code>, the number is inferred automatically by the
coefficient cut-off rule.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Standardized regression-coefficient threshold used in the
automatic exogenous–endogenous split. A variable is treated as endogenous
once its maximum standardized parent coefficient exceeds this value.
(Default: <code>0.1</code>)</p></dd>


<dt id="arg-auto-flipped">auto.flipped<a class="anchor" aria-label="anchor" href="#arg-auto-flipped"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, applies PC1-based automatic
sign flipping after standardization to ensure consistent orientation.
(Default: <code>TRUE</code>)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, prints progress messages and the
resulting variable split. (Default: <code>TRUE</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with:</p>
<dl><dt>endogenous.variables</dt>
<dd><p>Character vector of variables selected as endogenous (\(Y_1\)).</p></dd>

<dt>exogenous.variables</dt>
<dd><p>Character vector of variables selected as exogenous (\(Y_2\)).</p></dd>

<dt>ordered.variables</dt>
<dd><p>Variables in inferred causal order (from exogenous to endogenous).</p></dd>

<dt>is.flipped</dt>
<dd><p>Logical vector indicating which variables were sign-flipped during processing.</p></dd>

<dt>n.exogenous</dt>
<dd><p>Integer giving the number of exogenous variables.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kenichi Satoh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

