% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.ar}
\alias{nmfkc.ar}
\title{Creating observation and covariates for the vector autoregressive model}
\usage{
nmfkc.ar(Y, degree = 1, intercept = T)
}
\arguments{
\item{Y}{Observation matrices with columns in ascending order of measurement time point}

\item{degree}{lag degree for the autoregressive model, and the default value is 1.}

\item{intercept}{The default value is TRUE to add the intercept to the covariate matrix}
}
\value{
Y: observation matrix according to the degree of the autoregressive model

A: covariate matrix according to the degree of the autoregressive model

A.columns: subscript matrix used to create A

degree.max: 10log10(N) according to ar function in stats package
}
\description{
\code{nmfkc.ar} create observation matrix and covariate matrix according to the degree of the autoregressive model
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example.
d <- AirPassengers
time <- time(ts(1:length(d),start=c(1949,1),frequency=12))
time.vec <- round(as.vector(t(time)),2)
Y0 <- matrix(as.vector(d),nrow=1)
colnames(Y0) <- time.vec
rownames(Y0) <- "t"
# nmf with covariates
Q <- 1
D <- 12
a <- nmfkc.ar(Y0,degree=D,intercept=TRUE); Y <- a$Y; A <- a$A
res <- nmfkc(Y=Y,A=A,Q=Q,prefix="Factor",epsilon=1e-6)
res$r.squared
# coefficients
print.table(round(res$C,2),zero.print="")
# fitted curve
plot(as.numeric(colnames(Y)),as.vector(Y),type="l",col=1,xlab="",ylab="AirPassengers")
lines(as.numeric(colnames(Y)),as.vector(res$XB),col=2)
}
