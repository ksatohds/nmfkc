% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.ar}
\alias{nmfkc.ar}
\title{Construct observation and covariate matrices for a vector autoregressive model}
\source{
Satoh, K. (2025). Applying Non-negative Matrix Factorization with Covariates
to Multivariate Time Series Data as a Vector Autoregression Model.
Japanese Journal of Statistics and Data Science. \url{https://doi.org/10.1007/s42081-025-00314-0}
}
\usage{
nmfkc.ar(Y, degree = 1, intercept = T)
}
\arguments{
\item{Y}{An observation matrix, where columns are ordered by measurement time points.}

\item{degree}{The lag order of the autoregressive model. The default is 1.}

\item{intercept}{Logical. If TRUE (default), an intercept term is added to the covariate matrix.}
}
\value{
A list containing:
\item{Y}{Observation matrix constructed according to the specified lag order.}
\item{A}{Covariate matrix constructed according to the specified lag order.}
\item{A.columns}{Index matrix used to generate \code{A}.}
\item{degree.max}{Maximum lag order, set to \eqn{10 \log_{10}(N)} following the \code{ar} function in the \pkg{stats} package.}
}
\description{
\code{nmfkc.ar} generates the observation matrix and covariate matrix
corresponding to a specified autoregressive lag order.
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example.
d <- AirPassengers
time <- time(ts(1:length(d),start=c(1949,1),frequency=12))
time.vec <- round(as.vector(t(time)),2)
Y0 <- matrix(as.vector(d),nrow=1)
colnames(Y0) <- time.vec
rownames(Y0) <- "t"
# nmf with covariates
Q <- 1
D <- 12
a <- nmfkc.ar(Y0,degree=D,intercept=TRUE); Y <- a$Y; A <- a$A
res <- nmfkc(Y=Y,A=A,Q=Q,prefix="Factor",epsilon=1e-6)
res$r.squared
# coefficients
print.table(round(res$C,2),zero.print="")
# fitted curve
plot(as.numeric(colnames(Y)),as.vector(Y),type="l",col=1,xlab="",ylab="AirPassengers")
lines(as.numeric(colnames(Y)),as.vector(res$XB),col=2)
}
