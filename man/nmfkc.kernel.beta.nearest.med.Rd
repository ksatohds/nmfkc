% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.kernel.beta.nearest.med}
\alias{nmfkc.kernel.beta.nearest.med}
\title{Estimate kernel parameter beta from covariates}
\usage{
nmfkc.kernel.beta.nearest.med(U, block_size = 1000)
}
\arguments{
\item{U}{covariate matrix \eqn{U(K,N)=(u_1,\dots,u_N)},
where each column corresponds to an individual. Each row may be
normalized in advance.}

\item{block_size}{number of samples to process at once.
If \eqn{N \le 1000}, it is automatically set to \eqn{N}.}
}
\value{
A list with components:
\item{beta}{estimated kernel parameter \eqn{\beta=1/(2 d_{med}^2)}}
\item{beta_candidates}{a numeric vector of candidate values obtained by
varying the scale parameter \eqn{\sigma=d_{med}} by factors
\eqn{2^{-2},\,2^{-1},\,1,\,2^{1},\,2^{2}} and converting each to
\eqn{\beta=1/(2\sigma^2)}. The values are ordered from small to large.}
\item{dist_median}{the median nearest-neighbor distance}
\item{block_size_used}{actual block size used in computation}
}
\description{
\code{nmfkc.kernel.beta.nearest.med} estimates the Gaussian kernel
parameter \eqn{\beta} by computing the median of nearest-neighbor
distances among covariates. This is useful for setting the scale
parameter in kernel-based NMF with covariates.
}
\details{
The function computes all pairwise squared distances between columns of
\eqn{U}, excludes self-distances, and takes the median of the nearest-neighbor
distances (after square root). This median is then used to set \eqn{\beta}.
}
\seealso{
\code{\link{nmfkc.kernel}} for creating kernel matrices from covariates.
}
