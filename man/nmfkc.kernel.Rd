% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.kernel}
\alias{nmfkc.kernel}
\title{Creating kernel matrix from covariates}
\source{
Satoh, K. (2024) Applying Non-negative Matrix Factorization with Covariates to the Longitudinal Data as Growth Curve Model. arXiv preprint arXiv:2403.05359. \url{https://arxiv.org/abs/2403.05359}
}
\usage{
nmfkc.kernel(
  U,
  V = NULL,
  method = "Gaussian",
  beta = 0.5,
  degree = 2,
  centers = NULL,
  maxit = 5000,
  nstart = 1,
  seed = 123
)
}
\arguments{
\item{U}{covariate matrix U(K,N)=(u_1,...,u_N) each row might be normalized in advance}

\item{V}{covariate matrix V(K,M)=(v_1,...,v_M) usually used for prediction, and if it is NULL, the default value is U.}

\item{method}{The default kernel function is Gaussian kernel. For other functions, check by typing "nmfkc.kernel".}

\item{beta}{The default parameter of kernel function is 0.5.}

\item{degree}{The default parameter of kernel function is 2.}

\item{centers}{the number of clusters in kmeans function to reduce columns of U}

\item{maxit}{maximum number of iterations, "iter.max" in kmeans function}

\item{nstart}{The default is one, "nstart" in kmeans function}

\item{seed}{integer used as argument in "set.seed" function}
}
\value{
kernel matrix A(N,M)
}
\description{
\code{nmfkc.kernel} create kernel matrix from covariate matrix
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example.
Y <- matrix(cars$dist,nrow=1)
U <- matrix(cars$speed,nrow=1)
A <- nmfkc.kernel(U,beta=0.031,centers=3)
dim(A)
result <- nmfkc(Y,A,Q=1)
plot(as.vector(U),as.vector(Y))
lines(as.vector(U),as.vector(result$XB),col=2,lwd=2)
}
