% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.ar.degree.cv}
\alias{nmfkc.ar.degree.cv}
\title{Optimize lag order for the autoregressive model}
\usage{
nmfkc.ar.degree.cv(
  Y,
  Q = 2,
  degree = 1:2,
  intercept = T,
  div = 5,
  seed = 123,
  plot = TRUE,
  ...
)
}
\arguments{
\item{Y}{Observation matrix \eqn{Y(P,N)}.}

\item{Q}{Rank of the basis matrix. Must satisfy \eqn{Q \le \min(P,N)}.}

\item{degree}{A vector of candidate lag orders to be evaluated.}

\item{intercept}{Logical. If TRUE (default), an intercept is added to the covariate matrix.}

\item{div}{Number of partitions for cross-validation, corresponding to \eqn{k} in k-fold CV.}

\item{seed}{Integer seed for reproducibility, passed to \code{set.seed}.}

\item{plot}{Logical. If TRUE (default), a plot of the objective function values is drawn.}

\item{...}{Additional arguments passed to \code{nmfkc.cv}.}
}
\value{
A list with components:
\item{degree}{The lag order that minimizes the cross-validation objective function.}
\item{degree.max}{Maximum recommended lag order, computed as \eqn{10 \log_{10}(N)}
following the \code{ar} function in the \pkg{stats} package.}
\item{objfunc}{Objective function values for each candidate lag order.}
}
\description{
\code{nmfkc.ar.degree.cv} selects the optimal lag order for an autoregressive model
by applying cross-validation over candidate degrees.
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example.
d <- AirPassengers
time <- time(ts(1:length(d),start=c(1949,1),frequency=12))
time.vec <- round(as.vector(t(time)),2)
Y0 <- matrix(as.vector(d),nrow=1)
colnames(Y0) <- time.vec
rownames(Y0) <- "t"
# selection of degree
nmfkc.ar.degree.cv(Y=Y0,Q=1,degree=11:14)
}
\seealso{
\code{\link{nmfkc.ar}}, \code{\link{nmfkc.cv}}
}
