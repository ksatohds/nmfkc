% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmf.sem}
\alias{nmf.sem}
\title{NMF-SEM (Soft Constraint Version with Rank support)}
\usage{
nmf.sem(
  Y1,
  Y2,
  rank = NULL,
  X.L2.ortho = 100,
  C2.L2.off = 10,
  C1.L1 = 0.5,
  C2.L1 = 0,
  epsilon = 1e-06,
  maxit = 20000,
  seed = 123,
  ...
)
}
\arguments{
\item{Y1}{Endogenous variable matrix (P1 x N).}

\item{Y2}{Exogenous variable matrix (P2 x N).}

\item{rank}{Rank of the basis matrix (number of latent factors).
Can also be specified as \code{Q} for backward compatibility.}

\item{X.L2.ortho}{L2 penalty for orthogonality of X. Default is 100.0.}

\item{C2.L2.off}{L2 penalty for off-diagonal elements of Theta2 (C2). Default is 10.0.}

\item{C1.L1}{L1 penalty for Theta1 (C1). Default is 0.5.}

\item{C2.L1}{L1 penalty for the whole Theta2 (C2). Default is 0.0.}

\item{epsilon}{Positive convergence tolerance. Default is 1e-6.}

\item{maxit}{Maximum number of iterations. Default is 20000.}

\item{seed}{Integer seed for reproducibility. Default is 123.}

\item{...}{Additional arguments (e.g., \code{Q} for backward compatibility).}
}
\value{
A list containing:
\item{X}{Estimated basis matrix.}
\item{C1}{Estimated endogenous feedback coefficient matrix.}
\item{C2}{Estimated exogenous coefficient matrix.}
\item{objfunc}{Objective function values history.}
\item{iter}{Number of iterations performed.}
}
\description{
Fits a Structural Equation Model (SEM) within the Non-negative Matrix Factorization (NMF) framework.
The model approximates the endogenous variables \eqn{Y_1} using the structural equation:
\eqn{Y_1 \approx X (C_1 Y_1 + C_2 Y_2)}.
Here, \eqn{X} is the basis matrix representing latent factors, \eqn{C_1} captures the feedback effects
among endogenous variables, and \eqn{C_2} represents the influence of exogenous variables \eqn{Y_2} on the factors.
This function allows inducing diagonalization in \eqn{C_2} by imposing an L2 penalty on its off-diagonal elements.
}
