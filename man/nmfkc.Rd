% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc}
\alias{nmfkc}
\title{Optimizing NMF (Non-negative Matrix Factorization) with Kernel Covariate}
\usage{
nmfkc(
  Y,
  A = diag(ncol(Y)),
  Q = 2,
  gamma = 0,
  epsilon = 1e-04,
  maxit = 5000,
  method = "EU",
  X.column = "sum",
  print.trace = FALSE,
  print.dims = TRUE
)
}
\arguments{
\item{Y}{observation matrix}

\item{A}{covariate matrix. Without covariate, identity matrix is used.
Or matrix A(R,N) having N columns can be accepted.
kernel matrix A(N,N) can be created by nmfkc.kernel function.}

\item{Q}{rank of basis matrix and Q<=min(P,N)}

\item{gamma}{penalty parameter for C(Q,R) in objective function}

\item{epsilon}{positive convergence tolerance}

\item{maxit}{maximum number of iterations}

\item{method}{The default objective function is Euclid distance "EU", otherwise Kullbackâ€“Leibler divergence "KL"}

\item{X.column}{The default is X.column="sum" and the column sum of basis matrix is 1, and it is interpreted as probability. The column of basis matrix is unit vector when X.column="squared".}

\item{print.trace}{display current iteration every 10 times if print.trace=TRUE}

\item{print.dims}{display dimensions of matrix sizes if  print.dim=TRUE. The default is set by  print.dim=FALSE.}
}
\value{
X(P,Q): basis matrix. The column sum depends on X.column.

B(Q,N): B(Q,N)=C(Q,R)A(R,N) coefficient matrix

B.prob(Q,N): probability matrix whose column sum is 1
for soft clustering based on coefficient matrix B(Q,N).

B.cluster: the number of the basis that takes the maximum value of each column of B.prob(Q,N)
for hard clustering

XB(P,N): XB(P,N)=X(P,Q)B(Q,N) prediction matrix or fitted values for observation matrix Y

C(Q,R): parameter matrix

objfunc: last objective function

objfunc.iter: objective function at each iteration

r.squared: coefficient of determination R^2, squared correlation between Y(P,N) and XB(P,N)
}
\description{
\code{nmfkc} The goal of the package is to perform NMF (Non-negative Matrix Factorization) with Kernel Covariate described by Y(P,N)~X(P,Q)C(Q,R)A(R,N)=XB(Q,N)
where observation matrix Y(P,N),
covariate matrix A(R,N),
basis matrix X(P,Q) and Q<=min(P,N)
and parameter matrix C(Q,R).
Note that Y(N,P) and A(R,N) are given, and X(P,Q) and C(Q,R) are unknown.
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
library(nmfkc)
Y <- t(iris[,-5])
Q <- 2
result <- nmfkc(Y,Q=Q)
# visualization of some results
plot(result$objfunc.iter) # convergence

# goodness of fit
plot(as.vector(result$XB),as.vector(Y),
main=paste0("r.squared=",round(result$r.squared,3)))
abline(a=0,b=1,col=2)

# dimension reduction based on coefficient matrix B
plot(t(result$B))

# soft clustering based on coefficient matrix B
plot(t(result$B),col=as.numeric(iris$Species))
legend("topright",legend=1:Q,fill=1:Q+1)
stars(t(result$B.prob),locations=t(result$B),scale=FALSE,
  draw.segments=TRUE,col.segments=1:Q+1,len=0.2,add=TRUE)
}
