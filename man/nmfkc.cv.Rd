% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.cv}
\alias{nmfkc.cv}
\title{Performing k-fold cross validation on NMF (Non-negative Matrix Factorization) with Kernel Covariate}
\source{
Satoh, K. (2024) Applying Non-negative Matrix Factorization with Covariates to the Longitudinal Data as Growth Curve Model. arXiv preprint arXiv:2403.05359. \url{https://arxiv.org/abs/2403.05359}
}
\usage{
nmfkc.cv(
  Y,
  A = diag(ncol(Y)),
  Q = 2,
  gamma = 0,
  epsilon = 1e-04,
  maxit = 5000,
  method = "EU",
  X.column = "sum",
  div = 5,
  seed = 123
)
}
\arguments{
\item{Y}{observation matrix}

\item{A}{covariate matrix. Without covariate, identity matrix is used.}

\item{Q}{rank of basis matrix and Q<=min(P,N) where Y(P,N)}

\item{gamma}{penalty parameter for parameter matrix C}

\item{epsilon}{positive convergence tolerance}

\item{maxit}{maximum number of iterations}

\item{method}{default objective function is Euclid distance "EU", otherwise Kullback–Leibler divergence "KL"}

\item{X.column}{default is X.column="sum" and the column sum of basis matrix is 1, and it is interpreted as probability. The column of basis matrix is unit vector when X.column="squared".}

\item{div}{number of partition usually described as "k" of k-fold}

\item{seed}{integer used as argument in set.seed function
which controls the reproducibility of the partition.}
}
\value{
objfunc: last objective function

objfunc.block: objective function at each block

block: partition block index (1,...,div) assigned to each column of Y

r.squared: coefficient of determination R^2, squared correlation between Y and XB
}
\description{
\code{nmfkc.cv} apply cross validation method for k-partitioned columns of Y~XCA=XB
where observation matrix Y(P,N),
covariate matrix A(R,N),
basis matrix X(P,Q) and Q<=min(P,N),
parameter matrix C(Q,R)
and coefficient matrix B(Q,N).
Note that Y(N,P) and A(R,N) are given, and X(P,Q) and C(Q,R) are unknown.
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example 1.
Y <- matrix(cars$dist,nrow=1)
A <- rbind(1,cars$speed)
result <- nmfkc.cv(Y,A,Q=1)
result$objfunc

# Example 2.
Y <- matrix(cars$dist,nrow=1)
U <- matrix(c(5,10,15,20,25),nrow=1)
V <- matrix(cars$speed,nrow=1)
betas <- 20:40/1000
objfuncs <- 0*(1:length(betas))
for(i in 1:length(betas)){
  print(i)
  A <- nmfkc.kernel(U,V,beta=betas[i])
  result <- nmfkc.cv(Y,A,Q=1,div=10)
  objfuncs[i] <- result$objfunc
}
min(objfuncs)
(beta.best <- betas[which.min(objfuncs)])
# objective function by beta
plot(betas,objfuncs,type="o",log="x")
table(result$block) # partition block of cv
# fitted curve
A <- nmfkc.kernel(U,V,beta=beta.best)
result <- nmfkc(Y,A,Q=1)
plot(as.vector(V),as.vector(Y))
lines(as.vector(V),as.vector(result$XB),col=2,lwd=2)
}
\references{
Ding, Chris and Li, Tao and Peng, Wei and Park, Haesun (2006) Orthogonal Nonnegative Matrix Tri-Factorizations for Clustering, Proceedings of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining, 126-135. \url{https://doi.org/10.1145/1150402.1150420}

Potthoff, Richard F., and Roy, S. N. (1964) A generalized multivariate analysis of variance model useful especially for growth curve problems, Biometrika, 51 (3/4), 313–326. \url{https://doi.org/10.2307/2334137}
}
