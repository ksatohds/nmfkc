% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfkc.R
\name{nmfkc.kernel.beta.cv}
\alias{nmfkc.kernel.beta.cv}
\title{Optimize beta of the Gaussian kernel function by cross-validation}
\usage{
nmfkc.kernel.beta.cv(
  Y,
  Q = 2,
  U,
  V = NULL,
  beta = NULL,
  kernel = "Gaussian",
  degree = 2,
  div = 5,
  seed = 123,
  plot = TRUE,
  ...
)
}
\arguments{
\item{Y}{Observation matrix \eqn{Y(P,N)}.}

\item{Q}{Rank of the basis matrix. Must satisfy \eqn{Q \le \min(P,N)}.}

\item{U}{Covariate matrix \eqn{U(K,N) = (u_1, \dots, u_N)}. Each row may be normalized in advance.}

\item{V}{Covariate matrix \eqn{V(K,M) = (v_1, \dots, v_M)}, typically used for prediction. If \code{NULL}, the default is \code{U}.}

\item{beta}{A numeric vector of candidate kernel parameters to evaluate via cross-validation.}

\item{kernel}{Kernel function to use. Default is \code{"Gaussian"}. See \code{\link{nmfkc.kernel}} for available options.}

\item{degree}{Degree parameter for the \code{"Polynomial"} kernel. Default is 2.}

\item{div}{Number of partitions for cross-validation, corresponding to \eqn{k} in k-fold CV.}

\item{seed}{Integer seed for reproducibility, passed to \code{set.seed}.}

\item{plot}{Logical. If TRUE (default), plots the objective function values for each candidate \code{beta}.}

\item{...}{Additional arguments passed to \code{nmfkc.cv}.}
}
\value{
A list with components:
\item{beta}{The beta value that minimizes the cross-validation objective function.}
\item{objfunc}{Objective function values for each candidate \code{beta}.}
}
\description{
\code{nmfkc.kernel.beta.cv} selects the optimal beta parameter of the kernel function by applying cross-validation over a set of candidate values.
}
\examples{
# install.packages("remotes")
# remotes::install_github("ksatohds/nmfkc")
# Example.
Y <- matrix(cars$dist,nrow=1)
U <- matrix(c(5,10,15,20,25),nrow=1)
V <- matrix(cars$speed,nrow=1)
nmfkc.kernel.beta.cv(Y,Q=1,U,V,beta=25:30/1000)
A <- nmfkc.kernel(U,V,beta=28/1000)
result <- nmfkc(Y,A,Q=1)
plot(as.vector(V),as.vector(Y))
lines(as.vector(V),as.vector(result$XB),col=2,lwd=2)
}
