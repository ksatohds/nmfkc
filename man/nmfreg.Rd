% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nmfreg.R
\name{nmfreg}
\alias{nmfreg}
\title{Optimizing X and C on NMF:Y~XCA where Y and A are given}
\usage{
nmfreg(Y, A, Q = 2, gamma = 0, epsilon = 1e-04, maxit = 5000, method = "EU")
}
\arguments{
\item{Y}{observation matrix Y:PxN}

\item{A}{kernel matrix A:NxN. Without covariate, use identity matrix A=diag(ncol(Y)).}

\item{Q}{rank of basis matrix X:PxQ}

\item{gamma}{penalty parameter for C:QxN where objective function:tr(Y-YHAT)'(Y-YHAT)+gamma\emph{trC'C for method="EU" and sum(-Y}log(YHAT)+YHAT)+gamma*sum(C^2) for method="KL"}

\item{epsilon}{positive convergence tolerance}

\item{maxit}{maximum number of iterations}

\item{method}{default objective function uses Euclid distance "EU" and Kullbackâ€“Leibler divergence is used by method="KL".}
}
\value{
X:NxQ whose column sum is 1

C:QxN parameter matrix

B=XC: QxN coefficient matrix

P:PxN, calculated from B as P <- t(t(B)/colSums(B)) and probability matrix whose column sum is 1

objfunc: last objective function

objfunc.iter: objective function at each iteration

r.squared: squared correlation, i.e., coefficient of determination R^2 between Y and YHAT
}
\description{
\code{nmfreg} The goal of nmfreg is to perform NMF regression model described by Y~XCA
where observation matrix Y:PxN,
kernel matrix A:NxN with parameter beta,
rank of basis matrix X:PxQ whose column sum is 1
and coefficient matrix C:QxN,
Y and A are known, and X and C are unknown.
}
\examples{
# library(fda)
# data(CanadianWeather)
# d <- CanadianWeather$dailyAv[,,1]
# Y <- d-min(d)
# A <- diag(ncol(Y))
# library(nmfreg)
# result <- nmfreg(Y,A,Q=2)
# result$r.squared
}
